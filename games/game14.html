<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>è·Ÿç€å¼ å®¸é˜³å­¦ä¸‹æ¥¼æ¢¯</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* å…¨å±€æ ·å¼ */
        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #4682B4;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
        }
        header {
            background-color: #2F4F4F;
            width: 100%;
            padding: 20px;
            text-align: center;
            font-size: 2em;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        /* ä¸»èœå•æ ·å¼ */
        #main-menu {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 50px;
        }
        .menu-btn {
            background-color: #20B2AA;
            border: none;
            padding: 15px 30px;
            color: #fff;
            cursor: pointer;
            border-radius: 10px;
            font-size: 1.2em;
            margin: 10px 0;
            width: 200px;
            transition: background-color 0.3s, transform 0.2s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .menu-btn:hover {
            background-color: #3CB371;
            transform: scale(1.05);
        }
        /* ç« èŠ‚é€‰æ‹©ç•Œé¢æ ·å¼ */
        #chapter-select {
            display: none;
            flex-direction: column;
            align-items: center;
            margin-top: 50px;
        }
        .chapter-btn {
            background-color: #1E90FF;
            border: none;
            padding: 15px 30px;
            color: #fff;
            cursor: pointer;
            border-radius: 10px;
            font-size: 1.2em;
            margin: 10px 0;
            width: 220px;
            transition: background-color 0.3s, transform 0.2s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .chapter-btn:hover {
            background-color: #1C86EE;
            transform: scale(1.05);
        }
        .back-btn {
            background-color: #FF6347;
            border: none;
            padding: 10px 20px;
            color: #fff;
            cursor: pointer;
            border-radius: 8px;
            font-size: 1em;
            margin-top: 20px;
            transition: background-color 0.3s, transform 0.2s;
        }
        .back-btn:hover {
            background-color: #FF4500;
            transform: scale(1.05);
        }
        /* æ¸¸æˆå®¹å™¨æ ·å¼ */
        #game-container, #vocab-container, #achievements-container, #leaderboard-container {
            display: none;
            position: relative;
            width: 90%;
            max-width: 1000px;
            height: 600px;
            background: #6B8E23; /* ä¸‹æ¥¼æ¢¯ç¯å¢ƒç»¿è‰² */
            border: 5px solid #2F4F4F;
            margin: 20px 0;
            overflow: hidden;
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }
        /* ä½¿ç”¨CSSç»˜åˆ¶å¼ å®¸é˜³ */
        #zhang {
            position: absolute;
            bottom: 50px;
            left: 50px;
            width: 80px;
            height: 120px;
            background-color: #FFD700;
            border: 2px solid #000;
            border-radius: 10px;
            transition: left 0.5s, bottom 0.5s, transform 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            z-index: 2;
        }
        /* å¼ å®¸é˜³çš„èº«ä½“éƒ¨åˆ† */
        .zhang-body {
            width: 60%;
            height: 60%;
            background-color: #20B2AA;
            border-radius: 5px;
            margin-top: 10px;
        }
        /* å¼ å®¸é˜³çš„å¤´éƒ¨ */
        .zhang-head {
            width: 40px;
            height: 40px;
            background-color: #FFE4C4;
            border: 2px solid #000;
            border-radius: 50%;
            margin-top: -20px;
        }
        /* ä½¿ç”¨CSSç»˜åˆ¶æ¥¼æ¢¯ */
        #stairs {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 200px;
            background: repeating-linear-gradient(
                45deg,
                #8B4513,
                #8B4513 20px,
                #A0522D 20px,
                #A0522D 40px
            );
            z-index: 1;
        }
        /* é—®é¢˜æ¡†æ ·å¼ */
        #question-box {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(34, 139, 34, 0.9);
            padding: 20px;
            border-radius: 15px;
            display: none;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            z-index: 4;
        }
        #question-box h3 {
            margin-top: 0;
            font-size: 1.5em;
        }
        #answers {
            display: flex;
            flex-direction: column;
            margin-top: 15px;
        }
        .answer-btn {
            background-color: #32CD32;
            border: none;
            padding: 12px;
            margin: 8px 0;
            color: #fff;
            cursor: pointer;
            border-radius: 8px;
            font-size: 1em;
            transition: background-color 0.3s;
        }
        .answer-btn:hover {
            background-color: #3CB371;
        }
        /* åé¦ˆæ¡†æ ·å¼ */
        #feedback {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(255, 255, 255, 0.95);
            color: #000;
            padding: 30px;
            border-radius: 15px;
            display: none;
            text-align: center;
            width: 80%;
            max-width: 500px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            z-index: 5;
        }
        #feedback p {
            font-size: 1.2em;
            margin-bottom: 20px;
        }
        #feedback button {
            background-color: #1E90FF;
            border: none;
            padding: 15px 30px;
            color: #fff;
            cursor: pointer;
            border-radius: 10px;
            font-size: 1.2em;
            transition: background-color 0.3s;
        }
        #feedback button:hover {
            background-color: #1C86EE;
        }
        /* æˆå°±å’Œæ’è¡Œæ¦œæ ·å¼ */
        .container-title {
            text-align: center;
            font-size: 2em;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        .list {
            list-style: none;
            padding: 0;
            max-height: 400px;
            overflow-y: auto;
        }
        .list-item {
            background-color: #006400;
            margin: 10px auto;
            padding: 15px;
            border-radius: 10px;
            width: 80%;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            font-size: 1.2em;
        }
        /* è¯æ±‡å¡æ ·å¼ */
        #vocab-container {
            padding: 20px;
            position: relative;
            height: 600px;
            overflow-y: auto;
        }
        .vocab-card {
            background-color: #1E90FF;
            border: none;
            padding: 20px;
            margin: 10px auto;
            color: #fff;
            border-radius: 10px;
            width: 80%;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            position: relative;
            perspective: 1000px;
        }
        .vocab-card:hover {
            background-color: #1C86EE;
            transform: scale(1.02);
        }
        .vocab-term {
            font-size: 1.5em;
            font-weight: bold;
        }
        .vocab-definition {
            display: none;
            margin-top: 10px;
            font-size: 1.2em;
        }
        .vocab-card.flipped .vocab-definition {
            display: block;
        }
        .close-btn {
            position: absolute;
            top: 10px;
            right: 20px;
            background-color: transparent;
            border: none;
            color: #fff;
            font-size: 1.5em;
            cursor: pointer;
        }
        /* è¿›åº¦æ¡æ ·å¼ */
        #progress-bar {
            position: absolute;
            top: 0;
            left: 0;
            height: 10px;
            background-color: #32CD32;
            width: 0%;
            border-bottom-left-radius: 15px;
            border-bottom-right-radius: 15px;
            transition: width 0.5s;
            z-index: 6;
        }
        /* æ·»åŠ åŠ¨ç”»å…³é”®å¸§ */
        @keyframes celebrate {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(10deg); }
            50% { transform: rotate(-10deg); }
            75% { transform: rotate(10deg); }
            100% { transform: rotate(0deg); }
        }
        @keyframes shake {
            0% { transform: translate(0, 0); }
            25% { transform: translate(-10px, -10px); }
            50% { transform: translate(10px, -10px); }
            75% { transform: translate(-10px, 10px); }
            100% { transform: translate(10px, 10px); }
        }
        @keyframes trip {
            0% { transform: translateY(0); }
            50% { transform: translateY(30px); }
            100% { transform: translateY(0); }
        }
        @keyframes steady {
            0% { transform: translateX(0); }
            50% { transform: translateX(20px); }
            100% { transform: translateX(0); }
        }
        .celebrate {
            animation: celebrate 0.5s ease-in-out;
        }
        .shake {
            animation: shake 0.5s ease-in-out;
        }
        .trip {
            animation: trip 0.5s ease-in-out;
        }
        .steady {
            animation: steady 0.5s ease-in-out;
        }
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            header {
                font-size: 1.5em;
                padding: 15px;
            }
            #game-container, #vocab-container, #achievements-container, #leaderboard-container {
                height: 500px;
            }
            #zhang {
                width: 60px;
                height: 90px;
            }
            .zhang-body {
                width: 50%;
                height: 50%;
            }
            .zhang-head {
                width: 30px;
                height: 30px;
            }
            #question-box h3 {
                font-size: 1.2em;
            }
            .answer-btn {
                padding: 10px;
                font-size: 0.9em;
            }
            #feedback p {
                font-size: 1em;
            }
            #start-btn, #restart-btn, .back-btn {
                padding: 15px 30px;
                font-size: 1.2em;
            }
            .vocab-card {
                width: 90%;
            }
            .list-item {
                width: 90%;
            }
        }
    </style>
</head>
<body>

    <header>è·Ÿç€å¼ å®¸é˜³å­¦ä¸‹æ¥¼æ¢¯</header>

    <!-- ä¸»èœå• -->
    <div id="main-menu">
        <button class="menu-btn" id="start-game-btn">å¼€å§‹æ¸¸æˆ</button>
        <button class="menu-btn" id="vocab-btn">è¯æ±‡å¡</button>
        <button class="menu-btn" id="achievements-btn">æˆå°±</button>
        <button class="menu-btn" id="leaderboard-btn">æ’è¡Œæ¦œ</button>
    </div>

    <!-- ç« èŠ‚é€‰æ‹©ç•Œé¢ -->
    <div id="chapter-select">
        <div class="container-title">é€‰æ‹©ç« èŠ‚</div>
        <button class="chapter-btn" data-chapter="1">ç¬¬ä¸€ç« ï¼šåˆè¯†ä¸‹æ¥¼æ¢¯</button>
        <button class="chapter-btn" data-chapter="2">ç¬¬äºŒç« ï¼šå®‰å…¨æŠ€å·§</button>
        <!-- å¯ä»¥ç»§ç»­æ·»åŠ æ›´å¤šç« èŠ‚æŒ‰é’® -->
        <button class="back-btn" id="back-from-chapter-btn">è¿”å›ä¸»èœå•</button>
    </div>

    <!-- æ¸¸æˆå®¹å™¨ -->
    <div id="game-container">
        <!-- è¿›åº¦æ¡ -->
        <div id="progress-bar"></div>
        <!-- å¼ å®¸é˜³è§’è‰² -->
        <div id="zhang">
            <div class="zhang-head"></div>
            <div class="zhang-body"></div>
        </div>
        <!-- æ¥¼æ¢¯ -->
        <div id="stairs"></div>
        
        <!-- é—®é¢˜æ¡† -->
        <div id="question-box">
            <h3 id="question">é—®é¢˜æ–‡æœ¬</h3>
            <div id="answers">
                <!-- ç­”æ¡ˆæŒ‰é’® -->
            </div>
        </div>

        <!-- åé¦ˆæ¡† -->
        <div id="feedback">
            <p id="feedback-text">åé¦ˆä¿¡æ¯</p>
            <button id="next-btn">ç»§ç»­</button>
        </div>
    </div>

    <!-- è¯æ±‡å¡å®¹å™¨ -->
    <div id="vocab-container">
        <button class="close-btn" id="close-vocab-btn">&times;</button>
        <div class="container-title">ä¸‹æ¥¼æ¢¯è¯æ±‡å¡</div>
        <div id="vocab-cards">
            <!-- è¯æ±‡å¡ -->
        </div>
    </div>

    <!-- æˆå°±å®¹å™¨ -->
    <div id="achievements-container">
        <button class="close-btn" id="close-achievements-btn">&times;</button>
        <div class="container-title">æˆå°±</div>
        <ul class="list" id="achievements-list">
            <!-- æˆå°±åˆ—è¡¨ -->
        </ul>
    </div>

    <!-- æ’è¡Œæ¦œå®¹å™¨ -->
    <div id="leaderboard-container">
        <button class="close-btn" id="close-leaderboard-btn">&times;</button>
        <div class="container-title">æ’è¡Œæ¦œ</div>
        <ul class="list" id="leaderboard-list">
            <!-- æ’è¡Œæ¦œåˆ—è¡¨ -->
        </ul>
    </div>

    <script>
        // é—®é¢˜åº“
        const questions = [
            // ç¬¬ä¸€ç« 
            {
                chapter: 1,
                story: "ç¬¬ä¸€ç« ï¼šå¼ å®¸é˜³åˆæ¬¡å°è¯•ä¸‹æ¥¼æ¢¯ï¼Œæ„Ÿåˆ°æœ‰äº›ç´§å¼ ã€‚",
                question: "What is the recommended way to hold onto a handrail while descending stairs?",
                questionCN: "ä¸‹æ¥¼æ¢¯æ—¶ï¼Œæ¡ä½æ‰¶æ‰‹çš„æ¨èæ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ",
                answers: [
                    "Hold it with one hand while carrying something with the other",
                    "Use both hands to firmly grip the handrail",
                    "Only hold with one hand if necessary",
                    "Do not hold the handrail"
                ],
                correct: 1,
                explanation: "ä½¿ç”¨åŒæ‰‹ç‰¢å›ºåœ°æ¡ä½æ‰¶æ‰‹å¯ä»¥ç¡®ä¿ä¸‹æ¥¼æ—¶çš„ç¨³å®šå’Œå¹³è¡¡ã€‚",
                difficulty: "easy"
            },
            {
                chapter:1,
                story: "å¼ å®¸é˜³æ³¨æ„åˆ°æ¥¼æ¢¯çš„å°é˜¶æœ‰äº›æ»‘ã€‚",
                question: "What should you wear to reduce the risk of slipping on stairs?",
                questionCN: "ä½ åº”è¯¥ç©¿ä»€ä¹ˆæ¥é™ä½åœ¨æ¥¼æ¢¯ä¸Šæ»‘å€’çš„é£é™©ï¼Ÿ",
                answers: [
                    "High-heeled shoes",
                    "Loose sandals",
                    "Non-slip shoes",
                    "Flip-flops"
                ],
                correct:2,
                explanation: "é˜²æ»‘é‹å¯ä»¥æœ‰æ•ˆå‡å°‘åœ¨æ¥¼æ¢¯ä¸Šæ»‘å€’çš„é£é™©ã€‚",
                difficulty: "easy"
            },
            {
                chapter:1,
                story: "å¼ å®¸é˜³åœ¨ä¸‹æ¥¼æ—¶æ„Ÿåˆ°è„šæœ‰äº›ä¸é€‚ã€‚",
                question: "True or False: If you feel discomfort in your foot while going downstairs, you should stop immediately.",
                questionCN: "çœŸæˆ–å‡ï¼šå¦‚æœä¸‹æ¥¼æ—¶è„šæ„Ÿåˆ°ä¸é€‚ï¼Œåº”è¯¥ç«‹å³åœä¸‹ã€‚",
                answers: ["True", "False"],
                correct: 0,
                explanation: "å¦‚æœæ„Ÿåˆ°è„šä¸é€‚ï¼Œåº”è¯¥ç«‹å³åœä¸‹ï¼Œä»¥é¿å…è¿›ä¸€æ­¥å—ä¼¤ã€‚",
                difficulty: "easy"
            },
            {
                chapter:1,
                story: "å¼ å®¸é˜³æ­£åœ¨å­¦ä¹ å¦‚ä½•æ­£ç¡®ä¸‹æ¥¼æ¢¯ä»¥é¿å…å—ä¼¤ã€‚",
                question: "What is the proper posture to maintain while descending stairs?",
                questionCN: "ä¸‹æ¥¼æ¢¯æ—¶åº”ä¿æŒä»€ä¹ˆæ­£ç¡®çš„å§¿åŠ¿ï¼Ÿ",
                answers: [
                    "Lean forward with your weight on the toes",
                    "Keep your back straight and your weight on the heels",
                    "Hunch over to move faster",
                    "Look down at your feet continuously"
                ],
                correct:1,
                explanation: "ä¿æŒèƒŒéƒ¨æŒºç›´ï¼Œé‡å¿ƒæ”¾åœ¨è„šè·Ÿä¸Šï¼Œå¯ä»¥æé«˜ç¨³å®šæ€§å¹¶å‡å°‘å—ä¼¤é£é™©ã€‚",
                difficulty: "medium"
            },
            {
                chapter:1,
                story: "å¼ å®¸é˜³éœ€è¦å¿«é€Ÿååº”ä»¥é¿å…æ»‘å€’ã€‚",
                question: "What should you do if you start to slip on the stairs?",
                questionCN: "å¦‚æœä½ å¼€å§‹åœ¨æ¥¼æ¢¯ä¸Šæ»‘å€’ï¼Œåº”è¯¥æ€ä¹ˆåšï¼Ÿ",
                answers: [
                    "Try to catch yourself with your hands",
                    "Keep moving without using the handrail",
                    "Stop, hold onto the handrail, and stabilize yourself",
                    "Jump to the next step"
                ],
                correct:2,
                explanation: "åœä¸‹æ¥ï¼Œæ¡ä½æ‰¶æ‰‹ï¼Œç¨³å®šè‡ªå·±å¯ä»¥æœ‰æ•ˆé˜²æ­¢æ‘”å€’ã€‚",
                difficulty: "medium"
            },
            {
                chapter:1,
                story: "å¼ å®¸é˜³éœ€è¦äº†è§£æ¥¼æ¢¯çš„ç…§æ˜æƒ…å†µã€‚",
                question: "Why is proper lighting important when using stairs?",
                questionCN: "ä½¿ç”¨æ¥¼æ¢¯æ—¶ï¼Œé€‚å½“çš„ç…§æ˜ä¸ºä»€ä¹ˆå¾ˆé‡è¦ï¼Ÿ",
                answers: [
                    "To make the stairs look better",
                    "To see each step clearly and avoid missteps",
                    "To reduce energy consumption",
                    "To allow others to see you"
                ],
                correct:1,
                explanation: "é€‚å½“çš„ç…§æ˜å¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°æ¯ä¸ªå°é˜¶ï¼Œé¿å…è¸©ç©ºæˆ–ç»Šå€’ã€‚",
                difficulty: "medium"
            },
            {
                chapter:1,
                story: "å¼ å®¸é˜³åœ¨ä¸‹æ¥¼æ—¶å‘ç°æ‰¶æ‰‹æœ‰äº›æ¾åŠ¨ã€‚",
                question: "What should you do if you notice the handrail is loose?",
                questionCN: "å¦‚æœä½ å‘ç°æ‰¶æ‰‹æœ‰äº›æ¾åŠ¨ï¼Œåº”è¯¥æ€ä¹ˆåŠï¼Ÿ",
                answers: [
                    "Ignore it and continue",
                    "Use it cautiously",
                    "Report it to maintenance immediately",
                    "Try to tighten it yourself"
                ],
                correct:2,
                explanation: "åº”ç«‹å³å‘ç»´ä¿®éƒ¨é—¨æŠ¥å‘Šï¼Œä»¥ç¡®ä¿æ¥¼æ¢¯çš„å®‰å…¨æ€§ã€‚",
                difficulty: "hard"
            },
            {
                chapter:1,
                story: "å¼ å®¸é˜³å‡†å¤‡è¿›è¡Œä¸‹æ¥¼æ¢¯çš„å®‰å…¨æµ‹è¯•ã€‚",
                question: "What is a common sign that you need to rest while going downstairs?",
                questionCN: "ä¸‹æ¥¼æ¢¯æ—¶ï¼Œå¸¸è§çš„éœ€è¦ä¼‘æ¯çš„è¿¹è±¡æ˜¯ä»€ä¹ˆï¼Ÿ",
                answers: [
                    "Feeling dizzy or lightheaded",
                    "Feeling full of energy",
                    "Noticing the handrail",
                    "Looking around frequently"
                ],
                correct:0,
                explanation: "æ„Ÿåˆ°å¤´æ™•æˆ–å¤´æ˜æ˜¯éœ€è¦ä¼‘æ¯çš„å¸¸è§è¿¹è±¡ï¼Œä»¥é˜²æ­¢è·Œå€’ã€‚",
                difficulty: "hard"
            },
            {
                chapter:1,
                story: "å¼ å®¸é˜³å®Œæˆäº†ç¬¬ä¸€ç« çš„ä¸‹æ¥¼æ¢¯è®­ç»ƒã€‚",
                question: "What should you do after descending stairs to ensure your safety?",
                questionCN: "ä¸‹æ¥¼æ¢¯åï¼Œä½ åº”è¯¥åšä»€ä¹ˆä»¥ç¡®ä¿è‡ªå·±çš„å®‰å…¨ï¼Ÿ",
                answers: [
                    "Turn around and go back",
                    "Keep walking without checking",
                    "Ensure you are fully balanced before moving on",
                    "Run to your destination"
                ],
                correct:2,
                explanation: "ç¡®ä¿å®Œå…¨å¹³è¡¡åå†ç»§ç»­å‰è¿›ï¼Œå¯ä»¥é¿å…æ‘”å€’ã€‚",
                difficulty: "hard"
            },
            // ç¬¬äºŒç« 
            {
                chapter:2,
                story: "ç¬¬äºŒç« ï¼šå¼ å®¸é˜³çš„ä¸‹æ¥¼æ¢¯æŠ€å·§é€æ¸æå‡ã€‚",
                question: "What is the recommended speed for descending stairs?",
                questionCN: "ä¸‹æ¥¼æ¢¯çš„æ¨èé€Ÿåº¦æ˜¯å¤šå°‘ï¼Ÿ",
                answers: [
                    "As fast as possible",
                    "At a controlled and steady pace",
                    "Very slowly",
                    "Speed varies based on mood"
                ],
                correct:1,
                explanation: "ä»¥å—æ§ä¸”ç¨³å®šçš„é€Ÿåº¦ä¸‹æ¥¼å¯ä»¥å‡å°‘è·Œå€’çš„é£é™©ã€‚",
                difficulty: "easy"
            },
            {
                chapter:2,
                story: "å¼ å®¸é˜³éœ€è¦äº†è§£å¦‚ä½•å¤„ç†ä¸‹æ¥¼æ—¶çš„æ‰­ä¼¤ã€‚",
                question: "What is the first step you should take if you twist your ankle while descending stairs?",
                questionCN: "å¦‚æœä½ åœ¨ä¸‹æ¥¼æ¢¯æ—¶æ‰­ä¼¤äº†è„šè¸ï¼Œåº”è¯¥é‡‡å–çš„ç¬¬ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿ",
                answers: [
                    "Continue walking",
                    "Apply heat immediately",
                    "Stop and assess the injury",
                    "Massage the area vigorously"
                ],
                correct:2,
                explanation: "åº”ç«‹å³åœä¸‹å¹¶è¯„ä¼°å—ä¼¤æƒ…å†µï¼Œä»¥å†³å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨ã€‚",
                difficulty: "medium"
            },
            {
                chapter:2,
                story: "å¼ å®¸é˜³å­¦ä¹ å¦‚ä½•æ­£ç¡®ä½¿ç”¨è¾…åŠ©è®¾å¤‡ä¸‹æ¥¼ã€‚",
                question: "Which of the following can assist individuals with mobility issues when descending stairs?",
                questionCN: "ä»¥ä¸‹å“ªé¡¹å¯ä»¥å¸®åŠ©è¡ŒåŠ¨ä¸ä¾¿çš„äººå£«ä¸‹æ¥¼æ¢¯ï¼Ÿ",
                answers: [
                    "Handrails",
                    "Stair lifts",
                    "Non-slip mats",
                    "All of the above"
                ],
                correct:3,
                explanation: "æ‰¶æ‰‹ã€æ¥¼æ¢¯å‡é™æœºå’Œé˜²æ»‘å«éƒ½å¯ä»¥å¸®åŠ©è¡ŒåŠ¨ä¸ä¾¿çš„äººå£«å®‰å…¨ä¸‹æ¥¼ã€‚",
                difficulty: "medium"
            },
            {
                chapter:2,
                story: "å¼ å®¸é˜³éœ€è¦åŠ å¼ºä¸‹æ¥¼æ¢¯çš„å¹³è¡¡èƒ½åŠ›ã€‚",
                question: "What exercise can help improve balance for safer stair descent?",
                questionCN: "ä»€ä¹ˆé”»ç‚¼å¯ä»¥å¸®åŠ©æ”¹å–„å¹³è¡¡ï¼Œä»¥ä¾¿æ›´å®‰å…¨åœ°ä¸‹æ¥¼æ¢¯ï¼Ÿ",
                answers: [
                    "Running",
                    "Yoga",
                    "Weightlifting",
                    "Swimming"
                ],
                correct:1,
                explanation: "ç‘œä¼½å¯ä»¥æœ‰æ•ˆæ”¹å–„å¹³è¡¡èƒ½åŠ›ï¼Œæœ‰åŠ©äºæ›´å®‰å…¨åœ°ä¸‹æ¥¼æ¢¯ã€‚",
                difficulty: "medium"
            },
            {
                chapter:2,
                story: "å¼ å®¸é˜³åœ¨ä¸‹æ¥¼æ—¶æ„Ÿåˆ°è†ç›–æœ‰äº›ç–¼ç—›ã€‚",
                question: "True or False: Ignoring knee pain while descending stairs can lead to more serious injuries.",
                questionCN: "çœŸæˆ–å‡ï¼šåœ¨ä¸‹æ¥¼æ¢¯æ—¶å¿½è§†è†ç›–ç–¼ç—›å¯èƒ½å¯¼è‡´æ›´ä¸¥é‡çš„ä¼¤å®³ã€‚",
                answers: ["True", "False"],
                correct:0,
                explanation: "å¿½è§†è†ç›–ç–¼ç—›å¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥å—ä¼¤ï¼Œåº”åŠæ—¶ä¼‘æ¯å’Œæ²»ç–—ã€‚",
                difficulty: "hard"
            },
            {
                chapter:2,
                story: "å¼ å®¸é˜³å­¦ä¹ å¦‚ä½•åœ¨å¤œé—´å®‰å…¨ä¸‹æ¥¼æ¢¯ã€‚",
                question: "What should you do to ensure safety when descending stairs at night?",
                questionCN: "åœ¨å¤œé—´ä¸‹æ¥¼æ¢¯æ—¶ï¼Œä½ åº”è¯¥åšä»€ä¹ˆä»¥ç¡®ä¿å®‰å…¨ï¼Ÿ",
                answers: [
                    "Turn off all lights",
                    "Use a flashlight or ensure proper lighting",
                    "Descend quickly",
                    "Close your eyes while walking"
                ],
                correct:1,
                explanation: "ä½¿ç”¨æ‰‹ç”µç­’æˆ–ç¡®ä¿æœ‰é€‚å½“çš„ç…§æ˜å¯ä»¥å¸®åŠ©æ¸…æ™°åœ°çœ‹åˆ°æ¯ä¸ªå°é˜¶ï¼Œé˜²æ­¢è·Œå€’ã€‚",
                difficulty: "hard"
            },
            {
                chapter:2,
                story: "å¼ å®¸é˜³éœ€è¦å¤„ç†ä¸‹æ¥¼æ—¶çš„ç´§æ€¥æƒ…å†µã€‚",
                question: "What should you do if someone else trips and falls while you are descending stairs?",
                questionCN: "å¦‚æœåœ¨ä¸‹æ¥¼æ¢¯æ—¶å…¶ä»–äººç»Šå€’æ‘”å€’ï¼Œä½ åº”è¯¥æ€ä¹ˆåšï¼Ÿ",
                answers: [
                    "Ignore them and continue",
                    "Help them up immediately without assessing injuries",
                    "Assess their condition and provide assistance if needed",
                    "Laugh and walk away"
                ],
                correct:2,
                explanation: "åº”å…ˆè¯„ä¼°ä»–ä»¬çš„çŠ¶å†µï¼Œå¦‚æœéœ€è¦ï¼Œæä¾›é€‚å½“çš„å¸®åŠ©ã€‚",
                difficulty: "hard"
            },
            {
                chapter:2,
                story: "å¼ å®¸é˜³å®Œæˆäº†ç¬¬äºŒç« çš„ä¸‹æ¥¼æ¢¯è®­ç»ƒã€‚",
                question: "What should you do after descending stairs to ensure your safety?",
                questionCN: "ä¸‹æ¥¼æ¢¯åï¼Œä½ åº”è¯¥åšä»€ä¹ˆä»¥ç¡®ä¿è‡ªå·±çš„å®‰å…¨ï¼Ÿ",
                answers: [
                    "Turn around and go back",
                    "Keep walking without checking",
                    "Ensure you are fully balanced before moving on",
                    "Run to your destination"
                ],
                correct:2,
                explanation: "ç¡®ä¿å®Œå…¨å¹³è¡¡åå†ç»§ç»­å‰è¿›ï¼Œå¯ä»¥é¿å…æ‘”å€’ã€‚",
                difficulty: "hard"
            },
            // å¯ä»¥ç»§ç»­æ·»åŠ æ›´å¤šé—®é¢˜
        ];

        // è¯æ±‡åº“
        const vocabulary = [
            { term: "Handrail", definition: "æ‰¶æ‰‹ï¼Œä¸‹æ¥¼æ—¶ç”¨äºä¿æŒå¹³è¡¡çš„è£…ç½®ã€‚" },
            { term: "Non-slip Mat", definition: "é˜²æ»‘å«ï¼Œæ”¾åœ¨å°é˜¶ä¸Šä»¥é˜²æ­¢æ»‘å€’ã€‚" },
            { term: "Balance", definition: "å¹³è¡¡ï¼Œä¿æŒèº«ä½“ç¨³å®šçš„èƒ½åŠ›ã€‚" },
            { term: "Ankle Sprain", definition: "è„šè¸æ‰­ä¼¤ï¼Œå› è¿‡åº¦ä¼¸å±•æˆ–æ‰­æ›²å¯¼è‡´çš„è„šè¸ä¼¤å®³ã€‚" },
            { term: "Stair Lift", definition: "æ¥¼æ¢¯å‡é™æœºï¼Œå¸®åŠ©è¡ŒåŠ¨ä¸ä¾¿çš„äººå£«ä¸Šä¸‹æ¥¼æ¢¯çš„è®¾å¤‡ã€‚" },
            { term: "Proper Posture", definition: "æ­£ç¡®çš„å§¿åŠ¿ï¼Œä¿æŒèº«ä½“ç›´ç«‹ä»¥æé«˜ç¨³å®šæ€§ã€‚" },
            { term: "Flashlight", definition: "æ‰‹ç”µç­’ï¼Œæä¾›ç…§æ˜çš„ä¾¿æºè®¾å¤‡ã€‚" },
            { term: "Safety First", definition: "å®‰å…¨ç¬¬ä¸€ï¼Œä»»ä½•æƒ…å†µä¸‹éƒ½åº”ä¼˜å…ˆè€ƒè™‘å®‰å…¨ã€‚" },
            { term: "Spotting", definition: "è§‚å¯Ÿï¼Œå¯†åˆ‡æ³¨æ„å‘¨å›´ç¯å¢ƒä»¥é¢„é˜²è·Œå€’ã€‚" },
            { term: "Emergency Response", definition: "ç´§æ€¥åº”å¯¹ï¼Œå¤„ç†çªå‘æƒ…å†µçš„æªæ–½ã€‚" },
            { term: "Footwear", definition: "é‹ç±»ï¼Œé€‰æ‹©é€‚åˆçš„é‹å­å¯ä»¥å‡å°‘æ»‘å€’é£é™©ã€‚" },
            { term: "Dizziness", definition: "å¤´æ™•ï¼Œå¯èƒ½å¯¼è‡´å¤±å»å¹³è¡¡å’Œè·Œå€’çš„æ„Ÿè§‰ã€‚" },
            { term: "Lighting", definition: "ç…§æ˜ï¼Œç¡®ä¿æ¥¼æ¢¯åŒºåŸŸæ˜äº®ä»¥æé«˜å¯è§åº¦ã€‚" },
            { term: "Controlled Pace", definition: "å—æ§çš„é€Ÿåº¦ï¼Œä»¥ç¡®ä¿å®‰å…¨ä¸‹æ¥¼ã€‚" },
            { term: "Injury Assessment", definition: "ä¼¤å®³è¯„ä¼°ï¼Œç¡®å®šä¼¤åŠ¿ä¸¥é‡ç¨‹åº¦çš„è¿‡ç¨‹ã€‚" },
            { term: "Achilles Tendon", definition: "è·Ÿè…±ï¼Œè¿æ¥å°è…¿è‚Œè‚‰ä¸è„šè·Ÿéª¨çš„å¼ºéŸ§ç»„ç»‡ã€‚" },
            { term: "Proprioception", definition: "æœ¬ä½“æ„Ÿè§‰ï¼Œèº«ä½“å¯¹ä½ç½®å’Œè¿åŠ¨çš„æ„ŸçŸ¥èƒ½åŠ›ã€‚" },
            { term: "Synapse", definition: "çªè§¦ï¼Œç¥ç»å…ƒä¹‹é—´ä¼ é€’ä¿¡å·çš„æ¥ç‚¹ã€‚" },
            { term: "Homeostasis", definition: "ä½“å†…å¹³è¡¡ï¼Œç»´æŒå†…éƒ¨ç¯å¢ƒç¨³å®šçš„è¿‡ç¨‹ã€‚" },
            { term: "Physiotherapy", definition: "ç‰©ç†æ²»ç–—ï¼Œåˆ©ç”¨ç‰©ç†æ–¹æ³•å¸®åŠ©æ¢å¤èº«ä½“åŠŸèƒ½çš„æ²»ç–—æ–¹å¼ã€‚" },
            { term: "Baluster", definition: "æ æ†æŸ±ï¼Œæ¥¼æ¢¯æ‰¶æ‰‹æ—çš„è£…é¥°æ€§æŸ±å­ã€‚" },
            { term: "Cantilever", definition: "æ‚¬è‡‚æ¢ï¼Œåªåœ¨ä¸€ç«¯å›ºå®šçš„ç»“æ„æ¢ã€‚" },
            { term: "Tango Twist", definition: "æ¢æˆˆæ‰­è½¬ï¼Œä¸€ç§å¹½é»˜çš„æè¿°è„šè¸æ‰­ä¼¤çš„æœ¯è¯­ã€‚" },
            { term: "Banana Peel", definition: "é¦™è•‰çš®ï¼Œå¸¸è§çš„æ»‘å€’éšå–»ã€‚" },
            { term: "Physiology", definition: "ç”Ÿç†å­¦ï¼Œç ”ç©¶ç”Ÿç‰©ä½“åŠŸèƒ½çš„ç§‘å­¦ã€‚" },
            { term: "Rehabilitation", definition: "åº·å¤ï¼Œæ¢å¤èº«ä½“åŠŸèƒ½çš„è¿‡ç¨‹ã€‚" },
            { term: "Orthosis", definition: "çŸ«å½¢å™¨ï¼Œè¾…åŠ©æˆ–é™åˆ¶èº«ä½“éƒ¨ä½çš„è£…ç½®ã€‚" },
            { term: "Biomechanics", definition: "ç”Ÿç‰©åŠ›å­¦ï¼Œç ”ç©¶ç”Ÿç‰©ä½“è¿åŠ¨å’ŒåŠ›å­¦çš„å­¦ç§‘ã€‚" },
            { term: "Chiropractic", definition: "è„Šæ¤æŒ‰æ‘©ç–—æ³•ï¼Œé€šè¿‡æ‰‹æ³•è°ƒæ•´è„Šæ¤æ¥æ”¹å–„å¥åº·ã€‚" },
            { term: "Kinesiology", definition: "è¿åŠ¨å­¦ï¼Œç ”ç©¶äººä½“è¿åŠ¨çš„ç§‘å­¦ã€‚" },
            { term: "Gait Analysis", definition: "æ­¥æ€åˆ†æï¼Œè¯„ä¼°è¡Œèµ°æ–¹å¼ä»¥è¯Šæ–­é—®é¢˜çš„æŠ€æœ¯ã€‚" },
            { term: "Reversible Injury", definition: "å¯é€†ä¼¤å®³ï¼Œç»è¿‡é€‚å½“æ²»ç–—åå¯å®Œå…¨æ¢å¤çš„ä¼¤å®³ã€‚" },
            { term: "Axon", definition: "è½´çªï¼Œç¥ç»å…ƒä¼ é€’ä¿¡å·çš„é•¿çº¤ç»´éƒ¨åˆ†ã€‚" },
            { term: "Neuron", definition: "ç¥ç»å…ƒï¼Œç¥ç»ç³»ç»Ÿçš„åŸºæœ¬åŠŸèƒ½å•ä½ã€‚" },
            { term: "Homeostatic Mechanism", definition: "ä½“å†…å¹³è¡¡æœºåˆ¶ï¼Œç»´æŒèº«ä½“å†…éƒ¨ç¯å¢ƒç¨³å®šçš„ç³»ç»Ÿã€‚" },
            { term: "Proprioceptive Training", definition: "æœ¬ä½“æ„Ÿè§‰è®­ç»ƒï¼Œå¢å¼ºèº«ä½“å¯¹è‡ªèº«ä½ç½®å’Œè¿åŠ¨çš„æ„ŸçŸ¥èƒ½åŠ›çš„è®­ç»ƒã€‚" },
            // æ›´å¤šè¯æ±‡
        ];

        // æˆå°±åº“
        const achievements = [
            { name: "ä¸‹æ¥¼æ¢¯è¾¾äºº", description: "å®Œæˆç¬¬ä¸€ç« æ¸¸æˆã€‚", achieved: false },
            { name: "è¶…çº§å¼ å®¸é˜³", description: "è¿ç»­å›ç­”5ä¸ªé—®é¢˜æ­£ç¡®ã€‚", achieved: false },
            { name: "è¶…çº§ä¸‹æ¥¼æ¢¯ä¸“å®¶", description: "å›ç­”æ‰€æœ‰é—®é¢˜æ­£ç¡®ã€‚", achieved: false },
            { name: "è¯æ±‡è¾¾äºº", description: "å­¦ä¹ 10ä¸ªè¯æ±‡å¡ã€‚", achieved: false },
            { name: "é«˜åˆ†è¾¾äºº", description: "åœ¨æ’è¡Œæ¦œä¸­è¿›å…¥å‰5åã€‚", achieved: false },
            { name: "å®‰å…¨è¾¾äºº", description: "å®Œæˆæ‰€æœ‰ç« èŠ‚ã€‚", achieved: false },
            // æ›´å¤šæˆå°±
        ];

        // åˆå§‹åŒ–å˜é‡
        let currentQuestionIndex = 0;
        let score = 0;
        let currentChapter = null;
        let consecutiveCorrect = 0;
        const totalChapters = 2; // æ ¹æ®é—®é¢˜çº§åˆ«è°ƒæ•´
        let leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];

        // è·å–DOMå…ƒç´ 
        const mainMenu = document.getElementById('main-menu');
        const startGameBtn = document.getElementById('start-game-btn');
        const vocabBtn = document.getElementById('vocab-btn');
        const achievementsBtn = document.getElementById('achievements-btn');
        const leaderboardBtn = document.getElementById('leaderboard-btn');

        const chapterSelect = document.getElementById('chapter-select');
        const chapterButtons = document.querySelectorAll('.chapter-btn');
        const backFromChapterBtn = document.getElementById('back-from-chapter-btn');

        const gameContainer = document.getElementById('game-container');
        const zhang = document.getElementById('zhang');
        const stairs = document.getElementById('stairs');
        const questionBox = document.getElementById('question-box');
        const questionText = document.getElementById('question');
        const answersDiv = document.getElementById('answers');
        const feedback = document.getElementById('feedback');
        const feedbackText = document.getElementById('feedback-text');
        const nextBtn = document.getElementById('next-btn');
        const progressBar = document.getElementById('progress-bar');

        const vocabContainer = document.getElementById('vocab-container');
        const vocabCards = document.getElementById('vocab-cards');
        const closeVocabBtn = document.getElementById('close-vocab-btn');

        const achievementsContainer = document.getElementById('achievements-container');
        const achievementsList = document.getElementById('achievements-list');
        const closeAchievementsBtn = document.getElementById('close-achievements-btn');

        const leaderboardContainer = document.getElementById('leaderboard-container');
        const leaderboardList = document.getElementById('leaderboard-list');
        const closeLeaderboardBtn = document.getElementById('close-leaderboard-btn');

        // æ·»åŠ åŠ¨ç”»å…³é”®å¸§
        const styleSheet = document.createElement("style");
        styleSheet.type = "text/css";
        styleSheet.innerText = `
            @keyframes celebrate {
                0% { transform: rotate(0deg); }
                25% { transform: rotate(10deg); }
                50% { transform: rotate(-10deg); }
                75% { transform: rotate(10deg); }
                100% { transform: rotate(0deg); }
            }
            @keyframes shake {
                0% { transform: translate(0, 0); }
                25% { transform: translate(-10px, -10px); }
                50% { transform: translate(10px, -10px); }
                75% { transform: translate(-10px, 10px); }
                100% { transform: translate(10px, 10px); }
            }
            @keyframes trip {
                0% { transform: translateY(0); }
                50% { transform: translateY(30px); }
                100% { transform: translateY(0); }
            }
            @keyframes steady {
                0% { transform: translateX(0); }
                50% { transform: translateX(20px); }
                100% { transform: translateX(0); }
            }
            .celebrate {
                animation: celebrate 0.5s ease-in-out;
            }
            .shake {
                animation: shake 0.5s ease-in-out;
            }
            .trip {
                animation: trip 0.5s ease-in-out;
            }
            .steady {
                animation: steady 0.5s ease-in-out;
            }
        `;
        document.head.appendChild(styleSheet);

        // ç”Ÿæˆè¯æ±‡å¡
        function generateVocabCards() {
            vocabCards.innerHTML = '';
            vocabulary.forEach((vocab, index) => {
                const card = document.createElement('div');
                card.classList.add('vocab-card');
                card.innerHTML = `
                    <div class="vocab-term">${vocab.term}</div>
                    <div class="vocab-definition">${vocab.definition}</div>
                `;
                card.addEventListener('click', () => {
                    card.classList.toggle('flipped');
                });
                vocabCards.appendChild(card);
            });
        }

        // ç”Ÿæˆæˆå°±åˆ—è¡¨
        function generateAchievements() {
            achievementsList.innerHTML = '';
            achievements.forEach((achv, index) => {
                const li = document.createElement('li');
                li.classList.add('list-item');
                li.innerHTML = `
                    <strong>${achv.name}</strong><br>
                    ${achv.description} <br>
                    ${achv.achieved ? 'âœ… å·²è¾¾æˆ' : 'âŒ æœªè¾¾æˆ'}
                `;
                achievementsList.appendChild(li);
            });
        }

        // æ›´æ–°æˆå°±
        function updateAchievements() {
            achievements.forEach(achv => {
                if (!achv.achieved) {
                    if (achv.name === "åˆçº§å­¦è€…" && currentChapter > 1) {
                        achv.achieved = true;
                    }
                    if (achv.name === "ç²¾å‡†å›ç­”" && consecutiveCorrect >= 5) {
                        achv.achieved = true;
                    }
                    if (achv.name === "è¶…çº§å›ç­”è€…" && score >= getTotalQuestionsByChapter(currentChapter)) {
                        achv.achieved = true;
                    }
                    if (achv.name === "è¯æ±‡è¾¾äºº" && vocabulary.length >= 10) {
                        achv.achieved = true;
                    }
                    if (achv.name === "å®‰å…¨è¾¾äºº" && currentChapter > totalChapters) {
                        achv.achieved = true;
                    }
                    // æ›´å¤šæˆå°±æ¡ä»¶
                }
            });
            generateAchievements();
        }

        // ç”Ÿæˆæ’è¡Œæ¦œ
        function generateLeaderboard() {
            leaderboardList.innerHTML = '';
            // æ’åºå¹¶å–å‰10å
            const sortedLeaderboard = leaderboard.sort((a, b) => b.score - a.score).slice(0, 10);
            sortedLeaderboard.forEach((entry, index) => {
                const li = document.createElement('li');
                li.classList.add('list-item');
                li.textContent = `${index + 1}. ${entry.name} - ${entry.score}`;
                leaderboardList.appendChild(li);
            });
        }

        // ä¿å­˜æ’è¡Œæ¦œ
        function saveLeaderboard(name, score) {
            leaderboard.push({ name, score });
            localStorage.setItem('leaderboard', JSON.stringify(leaderboard));
            generateLeaderboard();
            updateAchievements();
        }

        // è·å–å½“å‰ç« èŠ‚çš„æ€»é—®é¢˜æ•°
        function getTotalQuestionsByChapter(chapter) {
            return questions.filter(q => q.chapter === chapter).length;
        }

        // åˆå§‹åŒ–è¯æ±‡å¡å’Œæˆå°±
        generateVocabCards();
        generateAchievements();
        generateLeaderboard();

        // å¯¼èˆªæŒ‰é’®äº‹ä»¶
        startGameBtn.addEventListener('click', () => {
            mainMenu.style.display = 'none';
            chapterSelect.style.display = 'flex';
        });

        vocabBtn.addEventListener('click', () => {
            mainMenu.style.display = 'none';
            vocabContainer.style.display = 'block';
        });

        achievementsBtn.addEventListener('click', () => {
            mainMenu.style.display = 'none';
            achievementsContainer.style.display = 'block';
        });

        leaderboardBtn.addEventListener('click', () => {
            mainMenu.style.display = 'none';
            leaderboardContainer.style.display = 'block';
        });

        backFromChapterBtn.addEventListener('click', () => {
            chapterSelect.style.display = 'none';
            mainMenu.style.display = 'flex';
        });

        // ç« èŠ‚é€‰æ‹©æŒ‰é’®äº‹ä»¶
        chapterButtons.forEach(button => {
            button.addEventListener('click', () => {
                const selectedChapter = parseInt(button.getAttribute('data-chapter'));
                currentChapter = selectedChapter;
                mainMenu.style.display = 'none';
                chapterSelect.style.display = 'none';
                gameContainer.style.display = 'block';
                startChapter();
            });
        });

        closeVocabBtn.addEventListener('click', () => {
            vocabContainer.style.display = 'none';
            mainMenu.style.display = 'flex';
        });

        closeAchievementsBtn.addEventListener('click', () => {
            achievementsContainer.style.display = 'none';
            mainMenu.style.display = 'flex';
        });

        closeLeaderboardBtn.addEventListener('click', () => {
            leaderboardContainer.style.display = 'none';
            mainMenu.style.display = 'flex';
        });

        // æ¸¸æˆé€»è¾‘
        function startChapter() {
            currentQuestionIndex = 0;
            score = 0;
            consecutiveCorrect = 0;
            progressBar.style.width = '0%';
            zhang.style.left = '50px'; // é‡ç½®å¼ å®¸é˜³çš„ä½ç½®
            moveZhang();
        }

        function moveZhang() {
            const currentChapterQuestions = questions.filter(q => q.chapter === currentChapter);
            if (currentQuestionIndex >= currentChapterQuestions.length) {
                endGame();
                return;
            }

            const q = currentChapterQuestions[currentQuestionIndex];
            // è®¾ç½®è¿›åº¦æ¡
            const progress = ((currentQuestionIndex) / getTotalQuestionsByChapter(currentChapter)) * 100;
            progressBar.style.width = progress + '%';
            // éšæœºä½ç½®
            const randomPositionX = Math.floor(Math.random() * (gameContainer.clientWidth - 100)) + 50;
            const randomPositionY = Math.floor(Math.random() * (gameContainer.clientHeight - 200)) + 100;
            zhang.style.left = randomPositionX + 'px';
            zhang.style.bottom = randomPositionY + 'px';
            // æ·»åŠ åŠ¨ç”»æ•ˆæœ
            zhang.style.transition = 'left 1s, bottom 1s';
            setTimeout(triggerQuestion, 1000);
        }

        function triggerQuestion() {
            questionBox.style.display = 'block';
            loadQuestion();
        }

        function loadQuestion() {
            const currentChapterQuestions = questions.filter(q => q.chapter === currentChapter);
            const q = currentChapterQuestions[currentQuestionIndex];
            if (!q) {
                endGame();
                return;
            }
            questionText.innerHTML = `<strong>${q.question}</strong><br><em>${q.questionCN}</em>`;
            answersDiv.innerHTML = '';
            q.answers.forEach((ans, index) => {
                const btn = document.createElement('button');
                btn.textContent = ans;
                btn.classList.add('answer-btn');
                btn.addEventListener('click', () => checkAnswer(index));
                answersDiv.appendChild(btn);
            });
        }

        function checkAnswer(selected) {
            const currentChapterQuestions = questions.filter(q => q.chapter === currentChapter);
            const q = currentChapterQuestions[currentQuestionIndex];
            questionBox.style.display = 'none';
            if (selected === q.correct) {
                score++;
                consecutiveCorrect++;
                feedbackText.innerHTML = `<strong>å›ç­”æ­£ç¡®ï¼ğŸ‘</strong><br>å¼ å®¸é˜³å®‰å…¨ä¸‹æ¥¼ï¼<br><em>${q.explanation}</em>`;
                triggerPositiveEvent();
            } else {
                consecutiveCorrect = 0;
                feedbackText.innerHTML = `<strong>å›ç­”é”™è¯¯ï¼ğŸ˜…</strong><br>å¼ å®¸é˜³åœ¨ä¸‹æ¥¼æ—¶å´´è„šäº†ï¼<br><em>${q.explanation}</em>`;
                triggerNegativeEvent();
            }
            updateAchievements();
            feedback.style.display = 'block';
        }

        function triggerPositiveEvent() {
            // ç§»åŠ¨å¼ å®¸é˜³å‘å³å¹¶æ·»åŠ åº†ç¥åŠ¨ç”»
            const newLeft = Math.min(gameContainer.clientWidth - 100, parseInt(zhang.style.left) + 100);
            zhang.style.left = newLeft + 'px';
            // æ·»åŠ åº†ç¥åŠ¨ç”»
            zhang.classList.add('celebrate');
            setTimeout(() => {
                zhang.classList.remove('celebrate');
            }, 500);
        }

        function triggerNegativeEvent() {
            // ç§»åŠ¨å¼ å®¸é˜³å‘å·¦å¹¶æ·»åŠ å¤±è¯¯åŠ¨ç”»
            const newLeft = Math.max(50, parseInt(zhang.style.left) - 50);
            zhang.style.left = newLeft + 'px';
            // æ·»åŠ å¤±è¯¯åŠ¨ç”»
            zhang.classList.add('shake');
            setTimeout(() => {
                zhang.classList.remove('shake');
            }, 500);
        }

        function endGame() {
            feedbackText.innerHTML = `<strong>æ¸¸æˆç»“æŸï¼ğŸ‰</strong><br>ä½ çš„å¾—åˆ†æ˜¯ ${score} / ${questions.filter(q => q.chapter === currentChapter).length}`;
            nextBtn.style.display = 'none';
            feedback.style.display = 'block';
            // ä¿å­˜åˆ°æ’è¡Œæ¦œ
            let playerName = prompt("è¯·è¾“å…¥ä½ çš„åå­—:", "ç©å®¶");
            if (playerName) {
                saveLeaderboard(playerName, score);
            }
        }

        nextBtn.addEventListener('click', () => {
            feedback.style.display = 'none';
            currentQuestionIndex++;
            moveZhang();
        });

        // ç”Ÿæˆè¯æ±‡å¡
        generateVocabCards();

        // ç”Ÿæˆæˆå°±åˆ—è¡¨
        generateAchievements();

        // ç”Ÿæˆæ’è¡Œæ¦œ
        generateLeaderboard();
    </script>

</body>
</html>
