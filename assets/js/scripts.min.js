// scripts.min.js

document.addEventListener('DOMContentLoaded', () => {
    const games = [
        {
            title: "Chris职业生涯模拟",
            description: "在一次次人生的路口为Chris作出重要抉择",
            image: "assets/images/game1-thumbnail.jpg",
            link: "games/game1.html",
            category: "action"
        },
        {
            title: "北中经营模拟",
            description: "如何管理一所学校，你说了算",
            image: "assets/images/game2-thumbnail.jpg",
            link: "games/game2.html",
            category: "puzzle"
        },
        {
            title: "徐浩宸历险记",
            description: "娱乐游戏，控制徐浩宸闯关",
            image: "assets/images/game3-thumbnail.jpg",
            link: "games/game3.html",
            category: "strategy"
        },
        // 添加更多游戏数据
    ];

    const gamesContainer = document.getElementById('gamesContainer');
    const filterButtons = document.querySelectorAll('.filter-btn');
    const searchInput = document.getElementById('searchInput');
    const searchButton = document.getElementById('searchButton');
    const themeToggle = document.getElementById('themeToggle');
    const themeIcon = document.getElementById('themeIcon');
    const noResults = document.getElementById('noResults');

    // 渲染游戏卡片
    function renderGames(gameList) {
        gamesContainer.innerHTML = '';
        if (gameList.length === 0) {
            noResults.style.display = 'block';
            return;
        } else {
            noResults.style.display = 'none';
        }
        gameList.forEach(game => {
            const card = document.createElement('div');
            card.className = 'game-card';
            card.innerHTML = `
                <img src="${game.image}" alt="${game.title}" loading="lazy">
                <div class="card-body">
                    <h3 class="card-title">${game.title}</h3>
                    <p class="card-text">${game.description}</p>
                    <a href="${game.link}" class="btn">开始游戏</a>
                </div>
            `;
            gamesContainer.appendChild(card);
        });
    }

    // 初始化游戏列表
    renderGames(games);

    // 分类过滤功能
    filterButtons.forEach(button => {
        button.addEventListener('click', () => {
            document.querySelector('.filter-btn.active').classList.remove('active');
            button.classList.add('active');
            const category = button.getAttribute('data-category');
            if (category === 'all') {
                renderGames(games);
            } else {
                const filtered = games.filter(game => game.category === category);
                renderGames(filtered);
            }
        });
    });

    // 搜索功能
    function searchGames() {
        const query = searchInput.value.trim().toLowerCase();
        const filtered = games.filter(game => 
            game.title.toLowerCase().includes(query) || 
            game.description.toLowerCase().includes(query)
        );
        renderGames(filtered);
    }

    searchButton.addEventListener('click', searchGames);
    searchInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            searchGames();
        }
    });

    // 主题切换功能
    function toggleTheme() {
        document.body.classList.toggle('dark-mode');
        if (document.body.classList.contains('dark-mode')) {
            themeIcon.innerHTML = `
                <path fill="currentColor" d="M279.135 512c-15.665 
                0-31.052-2.351-46.094-6.683-39.611-11.447-73.395-38.789-93.349-73.041 
                -19.952-34.252-25.679-73.531-16.408-111.335 
                4.65-20.486 12.868-40.047 24.368-57.256 
                11.505-17.205 26.14-32.309 42.349-44.299 
                16.21-11.989 33.81-21.342 52.32-27.48 
                18.51-6.14 37.765-9.72 56.733-9.72 
                50.441 0 98.56 19.843 137.368 55.486 
                38.808 35.643 61.486 84.984 61.486 138.467 
                0 50.441-19.843 98.56-55.486 
                137.368-35.643 38.808-84.984 61.486-138.467 
                61.486z"></path>
            `;
        } else {
            themeIcon.innerHTML = `
                <path fill="currentColor" d="M505 442.7L405.3 343c28.4-34.9 45.7-79.4 
                45.7-128C451 96.5 354.5 0 225.5 0S0 
                96.5 0 215.5 96.5 431 215.5 
                431c48.6 0 93.1-17.3 128-45.7l99.7 
                99.7c4.5 4.5 10.6 7 17 7s12.5-2.5 
                17-7c9.4-9.4 9.4-24.6 0-34zM215.5 
                368c-80.2 0-152.5-54.8-152.5-152.5S135.3 
                63 215.5 63 368 117.8 368 198s-72.3 
                152.5-152.5 152.5z"></path>
            `;
        }
        // 保存主题偏好
        if (document.body.classList.contains('dark-mode')) {
            localStorage.setItem('theme', 'dark');
        } else {
            localStorage.setItem('theme', 'light');
        }
    }

    // 初始化主题
    (function initTheme() {
        const theme = localStorage.getItem('theme');
        if (theme === 'dark') {
            document.body.classList.add('dark-mode');
            themeIcon.innerHTML = `
                <path fill="currentColor" d="M279.135 512c-15.665 
                0-31.052-2.351-46.094-6.683-39.611-11.447-73.395-38.789-93.349-73.041 
                -19.952-34.252-25.679-73.531-16.408-111.335 
                4.65-20.486 12.868-40.047 24.368-57.256 
                11.505-17.205 26.14-32.309 42.349-44.299 
                16.21-11.989 33.81-21.342 52.32-27.48 
                18.51-6.14 37.765-9.72 56.733-9.72 
                50.441 0 98.56 19.843 137.368 55.486 
                38.808 35.643 61.486 84.984 61.486 138.467 
                0 50.441-19.843 98.56-55.486 
                137.368-35.643 38.808-84.984 61.486-138.467 
                61.486z"></path>
            `;
        } else {
            themeIcon.innerHTML = `
                <path fill="currentColor" d="M505 442.7L405.3 343c28.4-34.9 45.7-79.4 
                45.7-128C451 96.5 354.5 0 225.5 0S0 
                96.5 0 215.5 96.5 431 215.5 
                431c48.6 0 93.1-17.3 128-45.7l99.7 
                99.7c4.5 4.5 10.6 7 17 7s12.5-2.5 
                17-7c9.4-9.4 9.4-24.6 0-34zM215.5 
                368c-80.2 0-152.5-54.8-152.5-152.5S135.3 
                63 215.5 63 368 117.8 368 198s-72.3 
                152.5-152.5 152.5z"></path>
            `;
        }
    })();

    themeToggle.addEventListener('click', toggleTheme);
});
